{{ $array := slice }}

{{- if $.Site.Params.enableSyntaxHighlighting -}}
    {{- if (eq $.Site.Params.syntaxHighlighter "prismjs") }}
        {{ $highlighter := resources.Get "js/lib/prism.js" }}
        {{ $highlighterStyle := resources.Get "css/prism.css" | minify }}

        <link rel="stylesheet" href="{{ $highlighterStyle.Permalink }}"> 
        {{ $array = $array | append $highlighter }}    
    {{- else -}}
        {{ $highlighter := resources.Get "js/lib/highlight.pack.js" }}
        {{ $highlighterStyle := resources.Get "css/highlightjs.css" | minify }}
    
        <link rel="stylesheet" href="{{ $highlighterStyle.Permalink }}">
        {{ $array = $array | append $highlighter }}
    {{- end -}}
{{- end -}}

<!-- MathJax -->
{{ if $.Site.Params.enableMathjax -}}
    {{ if $.Site.Params.setMathjaxToV3 -}}
        <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
    {{ else -}}
    {{ partial "config/mathjax.html" . }}
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/latest.js?config=TeX-MML-AM_CHTML" async></script>
    {{- end -}}
{{- end -}}

<!-- The custom script -->
{{ $global := resources.Get "js/toggle-node.js" | minify }}
{{- $array = $array | append $global -}}

{{- if $.Site.Params.enableSiteSearch -}}
{{ $searchEngineLib := resources.Get "js/lib/fuse.min.js" | minify  }}
{{ $searchEngineSearchScript := resources.Get "js/search-post.js" | minify }}
{{ $array = $array | append $searchEngineLib $searchEngineSearchScript }}
{{- end -}}

{{ $script := $array | resources.Concat "js/script.js" }}
<script type="text/javascript" src="{{ $script.Permalink }}"></script>

{{ if (and (or (eq $.Site.Params.syntaxHighlighter "highlighterjs") (not $.Site.Params.syntaxHighlighter)) $.Site.Params.enableSyntaxHighlighting) -}}
<script>hljs.initHighlightingOnLoad();</script>
{{- end -}}

{{- if $.Site.Params.enableSiteSearch -}}
<script type="text/javascript">
    loadIndex("{{ $.Site.BaseURL }}/index.search.json")
</script>
{{- end -}}
